---
sidebar_position: 1
---

# CVE-2025-55182: React Server Components Exploit

## Overview

CVE-2025-55182 is a critical vulnerability in React Server Components (RSC) that allows attackers to execute arbitrary code by manipulating serialized component data.

## The Vulnerability

React Server Components serialize data between server and client using special internal markers like `resolved_model` and `_response`. Attackers can craft payloads that exploit these internals.

### Attack Example
```json
{
  "resolved_model": {
    "_response": {
      "_prefix": "malicious_code",
      "constructor": {
        "prototype": {
          "isAdmin": true
        }
      }
    }
  }
}
```

## How nextjs-fortress Protects

### 1. Dangerous Key Detection
```typescript
const BLOCKED_KEYS = [
  '__proto__',
  'constructor',
  'prototype',
]

// ❌ Blocked immediately
{ "__proto__": { "isAdmin": true } }
```

### 2. RSC Pattern Detection
```typescript
const RSC_PATTERNS = [
  'resolved_model',
  '_response',
  '_prefix',
  '_formdata',
]

// ❌ Blocked immediately
{ "resolved_model": "..." }
```

### 3. Custom Prototype Detection
```typescript
// ❌ Blocked: Custom prototype chain
const evil = Object.create(Malicious.prototype)
```

## Real-World Impact

### Without Protection
```typescript
// API Route (vulnerable)
export async function POST(request) {
  const data = await request.json()  // ⚠️ Vulnerable!
  
  // Prototype is now polluted
  if (data.isAdmin) {  // This could be true!
    // Admin actions...
  }
}
```

### With Fortress
```typescript
// API Route (protected)
import { createWithFortress } from 'nextjs-fortress'

const withFortress = createWithFortress(config)

export const POST = withFortress(async (request) => {
  const data = await request.json()  // ✅ Validated!
  
  // Prototype pollution blocked
  // RSC patterns blocked
  // Safe to use data
})
```

## Testing Your Protection
```bash
# Test 1: Prototype pollution
curl -X POST http://localhost:3000/api/test \
  -H "Content-Type: application/json" \
  -d '{"__proto__": {"isAdmin": true}}'

# Expected: 403 Forbidden

# Test 2: RSC exploit
curl -X POST http://localhost:3000/api/test \
  -H "Content-Type: application/json" \
  -d '{"resolved_model": {"_response": "exploit"}}'

# Expected: 403 Forbidden
```

## References

- [CVE-2025-55182 Details](https://github.com/advisories/GHSA-xyz)
- [React Server Components Security](https://react.dev/reference/rsc/security)
- [Prototype Pollution Explained](https://portswigger.net/web-security/prototype-pollution)