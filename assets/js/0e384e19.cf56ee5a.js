"use strict";(globalThis.webpackChunkdocs=globalThis.webpackChunkdocs||[]).push([[976],{2053(e,n,t){t.r(n),t.d(n,{assets:()=>c,contentTitle:()=>l,default:()=>h,frontMatter:()=>o,metadata:()=>i,toc:()=>a});const i=JSON.parse('{"id":"intro","title":"What is nextjs-fortress","description":"Security Validation Middleware for Next.js","source":"@site/docs/intro.md","sourceDirName":".","slug":"/intro","permalink":"/nextjs-fortress/docs/intro","draft":false,"unlisted":false,"editUrl":"https://github.com/mindfiredigital/nextjs-fortress/tree/main/docs/docs/intro.md","tags":[],"version":"current","frontMatter":{},"sidebar":"tutorialSidebar","next":{"title":"Motivation","permalink":"/nextjs-fortress/docs/motivation"}}');var s=t(4848),r=t(8453);const o={},l="What is nextjs-fortress",c={},a=[{value:"What It Does",id:"what-it-does",level:2},{value:"Why You Need It",id:"why-you-need-it",level:2},{value:"Quick Example",id:"quick-example",level:2},{value:"Before (Vulnerable)",id:"before-vulnerable",level:3},{value:"After (Protected)",id:"after-protected",level:3},{value:"Key Features",id:"key-features",level:2},{value:"CVE-2025-55182 Protection",id:"cve-2025-55182-protection",level:3},{value:"Deep Inspection",id:"deep-inspection",level:3},{value:"Zero Performance Impact",id:"zero-performance-impact",level:3},{value:"Framework Agnostic",id:"framework-agnostic",level:3},{value:"Real-World Protection",id:"real-world-protection",level:2},{value:"Attack Blocked: Authentication Bypass",id:"attack-blocked-authentication-bypass",level:3},{value:"Attack Blocked: SQL Injection",id:"attack-blocked-sql-injection",level:3},{value:"Attack Blocked: Ghost Mode WAF Bypass",id:"attack-blocked-ghost-mode-waf-bypass",level:3},{value:"What Gets Protected",id:"what-gets-protected",level:2},{value:"Middleware (Automatic)",id:"middleware-automatic",level:3},{value:"Validation Levels",id:"validation-levels",level:2},{value:"Critical (Always Blocked)",id:"critical-always-blocked",level:3},{value:"High (Blocked in Production)",id:"high-blocked-in-production",level:3},{value:"Medium (Logged)",id:"medium-logged",level:3},{value:"Browser Compatibility",id:"browser-compatibility",level:2},{value:"Next Steps",id:"next-steps",level:2},{value:"License",id:"license",level:2},{value:"Support",id:"support",level:2}];function d(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",hr:"hr",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,r.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.header,{children:(0,s.jsx)(n.h1,{id:"what-is-nextjs-fortress",children:"What is nextjs-fortress"})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Security Validation Middleware for Next.js"})}),"\n",(0,s.jsx)(n.p,{children:"nextjs-fortress is a comprehensive security middleware that protects Next.js applications from CVE-2025-55182 (React2Shell) and all major attack vectors with zero configuration required."}),"\n",(0,s.jsx)(n.h2,{id:"what-it-does",children:"What It Does"}),"\n",(0,s.jsxs)(n.p,{children:["nextjs-fortress provides ",(0,s.jsx)(n.strong,{children:"7 layers of protection"})," that work together to secure your Next.js application:"]}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Deserialization Protection"})," - Blocks CVE-2025-55182 prototype pollution"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Injection Detection"})," - Prevents SQL, XSS, command, and code injection"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Encoding Validation"})," - Stops Ghost Mode WAF bypasses"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"CSRF Protection"})," - Defends against cross-site request forgery"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Rate Limiting"})," - Prevents brute-force and DoS attacks"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Content Validation"})," - Enforces payload size and type restrictions"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Security Headers"})," - Adds essential HTTP security headers"]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"why-you-need-it",children:"Why You Need It"}),"\n",(0,s.jsxs)(n.p,{children:["On January 5, 2025, the React2Shell vulnerability (CVE-2025-55182) was discovered in React Server Components. This critical vulnerability affects ",(0,s.jsx)(n.strong,{children:"every Next.js application"})," using Server Actions or Server Components."]}),"\n",(0,s.jsx)(n.p,{children:"Without protection:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Attackers can pollute JavaScript prototypes"}),"\n",(0,s.jsx)(n.li,{children:"Authentication can be completely bypassed"}),"\n",(0,s.jsx)(n.li,{children:"Privileges can be escalated to admin"}),"\n",(0,s.jsx)(n.li,{children:"Remote code execution is possible"}),"\n",(0,s.jsx)(n.li,{children:"WAFs can be bypassed using encoding tricks"}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:"With nextjs-fortress:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"All attack vectors blocked automatically"}),"\n",(0,s.jsx)(n.li,{children:"Zero configuration required"}),"\n",(0,s.jsx)(n.li,{children:"<1ms performance overhead"}),"\n",(0,s.jsx)(n.li,{children:"Works with existing code"}),"\n",(0,s.jsx)(n.li,{children:"Comprehensive security logging"}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"quick-example",children:"Quick Example"}),"\n",(0,s.jsx)(n.h3,{id:"before-vulnerable",children:"Before (Vulnerable)"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-typescript",children:"// app/api/user/route.ts\nexport async function POST(request: Request) {\n  const data = await request.json(); // \u26a0\ufe0f DANGEROUS\n  \n  // Vulnerable to:\n  // - Prototype pollution\n  // - SQL injection\n  // - XSS attacks\n  // - Command injection\n  \n  return updateUser(data);\n}\n"})}),"\n",(0,s.jsx)(n.h3,{id:"after-protected",children:"After (Protected)"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-typescript",children:"// middleware.ts\nimport { createFortressMiddleware } from 'nextjs-fortress';\nimport { fortressConfig } from './fortress.config';\n\nexport const middleware = createFortressMiddleware(fortressConfig);\n\n// app/api/user/route.ts\nexport async function POST(request: Request) {\n  const data = await request.json(); // \u2705 SAFE\n  \n  // Protected against:\n  // \u2713 Prototype pollution\n  // \u2713 SQL injection\n  // \u2713 XSS attacks\n  // \u2713 Command injection\n  // \u2713 Encoding bypasses\n  \n  return updateUser(data);\n}\n"})}),"\n",(0,s.jsx)(n.h2,{id:"key-features",children:"Key Features"}),"\n",(0,s.jsx)(n.h3,{id:"cve-2025-55182-protection",children:"CVE-2025-55182 Protection"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-typescript",children:'// Blocks all prototype pollution attempts\n{\n  "__proto__": { "isAdmin": true }        // BLOCKED\n  "constructor": { "prototype": {} }      // BLOCKED\n  "prototype": { "polluted": true }       // BLOCKED\n}\n'})}),"\n",(0,s.jsx)(n.h3,{id:"deep-inspection",children:"Deep Inspection"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Checks ALL object keys (including non-enumerable)"}),"\n",(0,s.jsx)(n.li,{children:"Scans nested objects recursively"}),"\n",(0,s.jsx)(n.li,{children:"Validates prototype chain"}),"\n",(0,s.jsx)(n.li,{children:"Detects circular references"}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"zero-performance-impact",children:"Zero Performance Impact"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-typescript",children:"// Benchmark: 1000 requests\nWithout fortress: 10ms\nWith fortress:    11ms\nOverhead:        +1ms (10%)\n"})}),"\n",(0,s.jsx)(n.h3,{id:"framework-agnostic",children:"Framework Agnostic"}),"\n",(0,s.jsx)(n.p,{children:"Works with:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"App Router (Next.js 13+)"}),"\n",(0,s.jsx)(n.li,{children:"Pages Router (Next.js 12+)"}),"\n",(0,s.jsx)(n.li,{children:"Server Actions"}),"\n",(0,s.jsx)(n.li,{children:"API Routes"}),"\n",(0,s.jsx)(n.li,{children:"Server Components"}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"real-world-protection",children:"Real-World Protection"}),"\n",(0,s.jsx)(n.h3,{id:"attack-blocked-authentication-bypass",children:"Attack Blocked: Authentication Bypass"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-typescript",children:'// Attacker payload\nPOST /api/login\n{\n  "username": "attacker",\n  "__proto__": { "isAdmin": true }\n}\n\n// Fortress response\n403 Forbidden\n{\n  "error": "Dangerous key detected: __proto__",\n  "rule": "dangerous_key"\n}\n'})}),"\n",(0,s.jsx)(n.h3,{id:"attack-blocked-sql-injection",children:"Attack Blocked: SQL Injection"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-typescript",children:'// Attacker payload\nPOST /api/search\n{\n  "query": "product\' UNION SELECT password FROM users--"\n}\n\n// Fortress response\n403 Forbidden\n{\n  "error": "SQL injection detected: UNION SELECT",\n  "rule": "sql_injection"\n}\n'})}),"\n",(0,s.jsx)(n.h3,{id:"attack-blocked-ghost-mode-waf-bypass",children:"Attack Blocked: Ghost Mode WAF Bypass"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-typescript",children:'// Attacker payload with UTF-16LE encoding\nPOST /api/data\nContent-Type: application/json; charset=utf-16le\nBody: [0xFF, 0xFE, ...] // __proto__ in UTF-16LE\n\n// Fortress response\n403 Forbidden\n{\n  "error": "UTF-16LE BOM detected (Ghost Mode WAF bypass)",\n  "rule": "bom_utf16le"\n}\n'})}),"\n",(0,s.jsx)(n.h2,{id:"what-gets-protected",children:"What Gets Protected"}),"\n",(0,s.jsx)(n.h3,{id:"middleware-automatic",children:"Middleware (Automatic)"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-typescript",children:"// ALL routes protected automatically\n\u2713 /api/*          - API routes\n\u2713 /app/*          - App router pages\n\u2713 /pages/*        - Pages router\n\u2713 Server Actions  - Form submissions\n\u2713 Server Components - RSC requests\n"})}),"\n",(0,s.jsx)(n.h2,{id:"validation-levels",children:"Validation Levels"}),"\n",(0,s.jsx)(n.h3,{id:"critical-always-blocked",children:"Critical (Always Blocked)"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Prototype pollution attempts"}),"\n",(0,s.jsx)(n.li,{children:"SQL injection"}),"\n",(0,s.jsx)(n.li,{children:"Command injection"}),"\n",(0,s.jsx)(n.li,{children:"Code injection"}),"\n",(0,s.jsx)(n.li,{children:"Encoding bypasses"}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"high-blocked-in-production",children:"High (Blocked in Production)"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"XSS attempts"}),"\n",(0,s.jsx)(n.li,{children:"Deep nesting attacks"}),"\n",(0,s.jsx)(n.li,{children:"Circular references"}),"\n",(0,s.jsx)(n.li,{children:"Dangerous patterns"}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"medium-logged",children:"Medium (Logged)"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Rate limit exceeded"}),"\n",(0,s.jsx)(n.li,{children:"Payload too large"}),"\n",(0,s.jsx)(n.li,{children:"Invalid encoding"}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"browser-compatibility",children:"Browser Compatibility"}),"\n",(0,s.jsx)(n.p,{children:"Works in all modern environments:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Next.js Edge Runtime"}),"\n",(0,s.jsx)(n.li,{children:"Node.js Runtime"}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"next-steps",children:"Next Steps"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.a,{href:"/nextjs-fortress/docs/quick-start",children:"Quick Start Guide"})," - Get protected in 5 minutes"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.a,{href:"/nextjs-fortress/docs/motivation",children:"Motivation Behind Guide"})," - Motivation Behind Building the middleware"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.a,{href:"/nextjs-fortress/docs/cve/cve-2025-55182",children:"CVE-2025-55182 Details"})," - Understand the vulnerability"]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"license",children:"License"}),"\n",(0,s.jsxs)(n.p,{children:["MIT License - See ",(0,s.jsx)(n.a,{href:"https://github.com/mindfiredigital/nextjs-fortress/blob/main/LICENSE",children:"LICENSE"})]}),"\n",(0,s.jsx)(n.h2,{id:"support",children:"Support"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"https://github.com/mindfiredigital/nextjs-fortress/issues",children:"Report Issues"})}),"\n"]}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"\u26a0\ufe0f Security Advisory:"})," CVE-2025-55182 is actively being exploited. Install nextjs-fortress immediately to protect your application."]})]})}function h(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(d,{...e})}):d(e)}},8453(e,n,t){t.d(n,{R:()=>o,x:()=>l});var i=t(6540);const s={},r=i.createContext(s);function o(e){const n=i.useContext(r);return i.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:o(e.components),i.createElement(r.Provider,{value:n},e.children)}}}]);