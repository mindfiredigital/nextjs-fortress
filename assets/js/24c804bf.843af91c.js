"use strict";(globalThis.webpackChunkdocs=globalThis.webpackChunkdocs||[]).push([[548],{3797(e,n,t){t.r(n),t.d(n,{assets:()=>a,contentTitle:()=>l,default:()=>h,frontMatter:()=>o,metadata:()=>s,toc:()=>c});const s=JSON.parse('{"id":"modules/injection/sql-injection","title":"SQL Injection Protection","description":"Overview","source":"@site/docs/modules/injection/sql-injection.md","sourceDirName":"modules/injection","slug":"/modules/injection/sql-injection","permalink":"/nextjs-fortress/docs/modules/injection/sql-injection","draft":false,"unlisted":false,"editUrl":"https://github.com/mindfiredigital/nextjs-fortress/tree/main/docs/docs/modules/injection/sql-injection.md","tags":[],"version":"current","frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"Dangerous Patterns Detection","permalink":"/nextjs-fortress/docs/modules/deserialization/dangerous-patterns"},"next":{"title":"Command Injection Protection","permalink":"/nextjs-fortress/docs/modules/injection/command-injection"}}');var i=t(7900),r=t(6493);const o={},l="SQL Injection Protection",a={},c=[{value:"Overview",id:"overview",level:2},{value:"Why This Is Important",id:"why-this-is-important",level:2},{value:"The Problem: SQL Injection Attacks",id:"the-problem-sql-injection-attacks",level:3},{value:"1. *<em>Authentication Bypass</em>",id:"1-authentication-bypass",level:4},{value:"2. <strong>Data Extraction (UNION SELECT)</strong>",id:"2-data-extraction-union-select",level:4},{value:"3. <strong>Data Destruction (DROP TABLE)</strong>",id:"3-data-destruction-drop-table",level:4},{value:"4. <strong>SQL Keyword Density Attack</strong>",id:"4-sql-keyword-density-attack",level:4},{value:"How nextjs-fortress Solves This",id:"how-nextjs-fortress-solves-this",level:2},{value:"Detection Methods",id:"detection-methods",level:3},{value:"1. <strong>Pattern Matching</strong>",id:"1-pattern-matching",level:4},{value:"2. <strong>Keyword Density Analysis</strong>",id:"2-keyword-density-analysis",level:4},{value:"3. <strong>Recursive Inspection</strong>",id:"3-recursive-inspection",level:4},{value:"Attack Examples",id:"attack-examples",level:2},{value:"Example 1: Login Bypass",id:"example-1-login-bypass",level:3},{value:"Example 2: Data Extraction",id:"example-2-data-extraction",level:3},{value:"Example 3: Table Deletion",id:"example-3-table-deletion",level:3},{value:"Example 4: Comment Injection",id:"example-4-comment-injection",level:3},{value:"SQL Keywords Monitored",id:"sql-keywords-monitored",level:2},{value:"How to Initialize",id:"how-to-initialize",level:2},{value:"Summary",id:"summary",level:2}];function d(e){const n={a:"a",code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",hr:"hr",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,r.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.header,{children:(0,i.jsx)(n.h1,{id:"sql-injection-protection",children:"SQL Injection Protection"})}),"\n",(0,i.jsx)(n.h2,{id:"overview",children:"Overview"}),"\n",(0,i.jsx)(n.p,{children:"SQL injection protection detects and blocks malicious SQL code in request payloads that could manipulate database queries and compromise data security."}),"\n",(0,i.jsx)(n.h2,{id:"why-this-is-important",children:"Why This Is Important"}),"\n",(0,i.jsx)(n.h3,{id:"the-problem-sql-injection-attacks",children:"The Problem: SQL Injection Attacks"}),"\n",(0,i.jsx)(n.p,{children:"Attackers inject SQL code into inputs to manipulate database queries:"}),"\n",(0,i.jsxs)(n.h4,{id:"1-authentication-bypass",children:["1. *",(0,i.jsx)(n.em,{children:"Authentication Bypass"})]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-javascript",children:"// Login form payload\n{\n  \"username\": \"admin' OR '1'='1\",\n  \"password\": \"anything\"\n}\n\n// Without protection, query becomes:\nSELECT * FROM users \nWHERE username = 'admin' OR '1'='1' \nAND password = 'anything'\n\n// Result: '1'='1' is always true\n// Attacker logs in without knowing password\n"})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"What Happens Without Protection:"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Authentication completely bypassed"}),"\n",(0,i.jsx)(n.li,{children:"Any account accessible"}),"\n",(0,i.jsx)(n.li,{children:"No password needed"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Impact:"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Complete authentication bypass"}),"\n",(0,i.jsx)(n.li,{children:"Account takeover"}),"\n",(0,i.jsx)(n.li,{children:"Unauthorized data access"}),"\n",(0,i.jsx)(n.li,{children:"Financial fraud"}),"\n"]}),"\n",(0,i.jsxs)(n.h4,{id:"2-data-extraction-union-select",children:["2. ",(0,i.jsx)(n.strong,{children:"Data Extraction (UNION SELECT)"})]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-javascript",children:"// Search query payload\n{\n  \"search\": \"product' UNION SELECT username, password FROM users--\"\n}\n\n// Without protection, query becomes:\nSELECT name, price FROM products \nWHERE name = 'product' UNION SELECT username, password FROM users--'\n\n// Result: Returns all usernames and passwords\n"})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"What Happens Without Protection:"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Database schema revealed"}),"\n",(0,i.jsx)(n.li,{children:"User credentials stolen"}),"\n",(0,i.jsx)(n.li,{children:"Sensitive data exposed"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Impact:"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Complete database dump"}),"\n",(0,i.jsx)(n.li,{children:"Password theft"}),"\n",(0,i.jsx)(n.li,{children:"Payment information stolen"}),"\n",(0,i.jsx)(n.li,{children:"User data breach"}),"\n"]}),"\n",(0,i.jsxs)(n.h4,{id:"3-data-destruction-drop-table",children:["3. ",(0,i.jsx)(n.strong,{children:"Data Destruction (DROP TABLE)"})]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-javascript",children:"// Delete product payload\n{\n  \"productId\": \"123'; DROP TABLE products--\"\n}\n\n// Without protection, query becomes:\nDELETE FROM products WHERE id = '123'; DROP TABLE products--'\n\n// Result: Entire products table deleted\n"})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"What Happens Without Protection:"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Critical tables dropped"}),"\n",(0,i.jsx)(n.li,{children:"Data permanently deleted"}),"\n",(0,i.jsx)(n.li,{children:"Application breaks completely"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Impact:"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Data destruction"}),"\n",(0,i.jsx)(n.li,{children:"Permanent data loss"}),"\n",(0,i.jsx)(n.li,{children:"Business disruption"}),"\n",(0,i.jsx)(n.li,{children:"Revenue loss"}),"\n"]}),"\n",(0,i.jsxs)(n.h4,{id:"4-sql-keyword-density-attack",children:["4. ",(0,i.jsx)(n.strong,{children:"SQL Keyword Density Attack"})]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-javascript",children:"// Sophisticated payload using many SQL keywords\n{\n  \"query\": \"SELECT * FROM users WHERE id = 1 AND role = 'admin' OR status = 'active' JOIN permissions ON users.id = permissions.user_id\"\n}\n\n// High concentration of SQL keywords indicates injection attempt\n// Keywords: SELECT, FROM, WHERE, AND, OR, JOIN, ON\n"})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"What Happens Without Protection:"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Complex injection succeeds"}),"\n",(0,i.jsx)(n.li,{children:"Multiple tables queried"}),"\n",(0,i.jsx)(n.li,{children:"Privileged data accessed"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Impact:"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Targeted data extraction"}),"\n",(0,i.jsx)(n.li,{children:"Privilege escalation"}),"\n",(0,i.jsx)(n.li,{children:"Multi-table data theft"}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"how-nextjs-fortress-solves-this",children:"How nextjs-fortress Solves This"}),"\n",(0,i.jsx)(n.h3,{id:"detection-methods",children:"Detection Methods"}),"\n",(0,i.jsxs)(n.h4,{id:"1-pattern-matching",children:["1. ",(0,i.jsx)(n.strong,{children:"Pattern Matching"})]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"export const SQL_PATTERNS = [\n  /(\\bUNION\\b.*\\bSELECT\\b)/gi,      // UNION SELECT\n  /(\\bINSERT\\b.*\\bINTO\\b)/gi,       // INSERT INTO\n  /(\\bDELETE\\b.*\\bFROM\\b)/gi,       // DELETE FROM\n  /(\\bDROP\\b.*\\bTABLE\\b)/gi,        // DROP TABLE\n  /(\\bUPDATE\\b.*\\bSET\\b)/gi,        // UPDATE SET\n  /(\\bEXEC(UTE)?\\b)/gi,             // EXEC/EXECUTE\n  /(\\bSELECT\\b.*\\bFROM\\b)/gi,       // SELECT FROM\n  /(;\\s*--)/g,                       // Comment injection\n  /('|\" \\s*OR\\s*'1'\\s*=\\s*'1)/gi,   // OR 1=1\n  /(\\bOR\\b.*=.*)/gi,                 // OR conditions\n  /(\\bAND\\b.*=.*)/gi,                // AND conditions\n];\n"})}),"\n",(0,i.jsxs)(n.h4,{id:"2-keyword-density-analysis",children:["2. ",(0,i.jsx)(n.strong,{children:"Keyword Density Analysis"})]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"/**\n * Check SQL keyword density (high density = likely injection)\n */\nprivate checkSQLKeywordDensity(str: string): ValidationResult {\n  const words = str.toUpperCase().split(/\\s+/);\n  const keywordCount = words.filter(word => \n    SQL_KEYWORDS.includes(word)\n  ).length;\n  \n  const density = words.length > 0 ? keywordCount / words.length : 0;\n\n  // If more than 30% of words are SQL keywords, flag it\n  if (density > 0.3 && keywordCount >= 3) {\n    return {\n      valid: false,\n      severity: 'high',\n      message: `High SQL keyword density detected (${(density * 100).toFixed(0)}%)`,\n      rule: 'sql_keyword_density',\n      confidence: Math.min(density * 2, 1),\n    };\n  }\n\n  return { valid: true };\n}\n"})}),"\n",(0,i.jsxs)(n.h4,{id:"3-recursive-inspection",children:["3. ",(0,i.jsx)(n.strong,{children:"Recursive Inspection"})]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"/**\n * Extract all strings from input (including nested objects)\n */\nprivate extractStrings(input: unknown, depth: number = 0): string[] {\n  const strings: string[] = [];\n  const maxDepth = 10;\n\n  if (depth > maxDepth) return strings;\n\n  if (typeof input === 'string') {\n    strings.push(input);\n  } else if (Array.isArray(input)) {\n    for (const item of input) {\n      strings.push(...this.extractStrings(item, depth + 1));\n    }\n  } else if (input !== null && typeof input === 'object') {\n    for (const value of Object.values(input)) {\n      strings.push(...this.extractStrings(value, depth + 1));\n    }\n  }\n\n  return strings;\n}\n"})}),"\n",(0,i.jsx)(n.h2,{id:"attack-examples",children:"Attack Examples"}),"\n",(0,i.jsx)(n.h3,{id:"example-1-login-bypass",children:"Example 1: Login Bypass"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-javascript",children:"// Attacker login attempt\nPOST /api/auth/login\n{\n  \"username\": \"admin' OR '1'='1'--\",\n  \"password\": \"irrelevant\"\n}\n\n// Fortress detects:\n// Pattern match: \"OR '1'='1'\" found\n// Severity: critical\n// Result: BLOCKED \n// Message: \"SQL injection detected: OR '1'='1'\"\n"})}),"\n",(0,i.jsx)(n.h3,{id:"example-2-data-extraction",children:"Example 2: Data Extraction"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-javascript",children:'// Attacker search request\nPOST /api/products/search\n{\n  "query": "laptop\' UNION SELECT email, password FROM users--"\n}\n\n// Fortress detects:\n// Pattern match: "UNION SELECT" found\n// Severity: critical\n// Result: BLOCKED \n'})}),"\n",(0,i.jsx)(n.h3,{id:"example-3-table-deletion",children:"Example 3: Table Deletion"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-javascript",children:'// Attacker delete request\nDELETE /api/product/123\n{\n  "id": "123\'; DROP TABLE products; --"\n}\n\n// Fortress detects:\n// Pattern match: "DROP TABLE" found\n// Severity: critical\n// Result: BLOCKED \n'})}),"\n",(0,i.jsx)(n.h3,{id:"example-4-comment-injection",children:"Example 4: Comment Injection"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-javascript",children:'// Attacker comment injection\nPOST /api/comment\n{\n  "text": "Nice product\'; DELETE FROM comments WHERE \'1\'=\'1"\n}\n\n// Fortress detects:\n// Pattern match: "DELETE FROM" found\n// Severity: critical\n// Result: BLOCKED \n'})}),"\n",(0,i.jsx)(n.h2,{id:"sql-keywords-monitored",children:"SQL Keywords Monitored"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"export const SQL_KEYWORDS = [\n  'SELECT', 'FROM', 'WHERE', 'INSERT', 'UPDATE',\n  'DELETE', 'UNION', 'JOIN', 'DROP', 'CREATE',\n  'ALTER', 'TABLE', 'DATABASE', 'EXEC', 'EXECUTE',\n  'AND', 'OR',\n];\n"})}),"\n",(0,i.jsx)(n.h2,{id:"how-to-initialize",children:"How to Initialize"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"import { FortressConfig, FortressLogger } from '@mindfiredigital/nextjs-fortress';\n\nexport const fortressConfig: FortressConfig = {\n  enabled: true,\n  mode: 'development',\n\n  modules: {\n    injection: {\n      enabled: true,\n      checks: ['sql'],\n      \n      // Optional: Add custom SQL patterns\n      customPatterns: [\n        /\\bTRUNCATE\\b/gi,\n        /\\bALTER\\b/gi,\n      ],\n    },\n  },\n\n  onSecurityEvent: async (event) => {\n    if (event.detection.rule === 'sql_injection') {\n      const logger = new FortressLogger({\n        enabled: true,\n        level: 'warn',\n        destination: 'console',\n      });\n\n      logger.warn('\ud83d\udea8 SQL Injection Attempt', {\n        pattern: event.detection.pattern,\n        ip: event.request.ip,\n        path: event.request.path,\n      });\n    }\n  },\n};\n"})}),"\n",(0,i.jsx)(n.h2,{id:"summary",children:"Summary"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"What happens without SQL injection protection:"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Authentication bypass"}),"\n",(0,i.jsx)(n.li,{children:"Data theft"}),"\n",(0,i.jsx)(n.li,{children:"Database destruction"}),"\n",(0,i.jsx)(n.li,{children:"Complete compromise"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"What nextjs-fortress provides:"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Pattern-based detection"}),"\n",(0,i.jsx)(n.li,{children:"Keyword density analysis"}),"\n",(0,i.jsx)(n.li,{children:"Recursive payload scanning"}),"\n",(0,i.jsx)(n.li,{children:"Custom pattern support"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"How to initialize:"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"injection: {\n  enabled: true,\n  checks: ['sql'],  // Enable SQL injection detection\n}\n"})}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Related Documentation:"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"/nextjs-fortress/docs/modules/injection/command-injection",children:"Command Injection Protection"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"/nextjs-fortress/docs/modules/injection/xss-protection",children:"XSS Protection"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"/nextjs-fortress/docs/modules/injection/code-injection",children:"Code Injection Protection"})}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(d,{...e})}):d(e)}},6493(e,n,t){t.d(n,{R:()=>o,x:()=>l});var s=t(2128);const i={},r=s.createContext(i);function o(e){const n=s.useContext(r);return s.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:o(e.components),s.createElement(r.Provider,{value:n},e.children)}}}]);